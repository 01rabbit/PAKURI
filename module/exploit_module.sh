function exploit_banner()
{
    echo -e "${RED}"
    echo -e " ███████╗██╗  ██╗██████╗ ██╗      ██████╗ ██╗████████╗"
    echo -e " ██╔════╝╚██╗██╔╝██╔══██╗██║     ██╔═══██╗██║╚══██╔══╝"
    echo -e " █████╗   ╚███╔╝ ██████╔╝██║     ██║   ██║██║   ██║   "
    echo -e " ██╔══╝   ██╔██╗ ██╔═══╝ ██║     ██║   ██║██║   ██║   "
    echo -e " ███████╗██╔╝ ██╗██║     ███████╗╚██████╔╝██║   ██║   "
    echo -e " ╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝   ╚═╝   "
    echo -e "   -With great power comes great responsibility.-"
    echo -e "${NC}"
}

function exploit_manage()
{
    local key
    local ans
    
    tmux select-pane -t $WINDOW_NAME.0
    while :
    do
        clear
        exploit_banner
        date
        echo -e "------------------- Exploit Menu --------------------"
        echo -e "+---+"
        echo -e "| 1 | Create and initialize the msf database"
        echo -e "+---+"
        echo -e "+---+"
        echo -e "| 2 | Delete msf database"
        echo -e "+---+"
        echo -e "+---+"
        echo -e "| 3 | Start Matasploit"
        echo -e "+---+"
        echo -e "+---+"
        echo -e "| 4 | Import to msf database"
        echo -e "+---+"
        echo -e "+---+"
        echo -e "| 5 | Check the hosts registered in the msf database"
        echo -e "+---+"
        echo -e "+---+"
        echo -e "| 6 | Check the services registered in the msf database"
        echo -e "+---+"
        echo -e "+---+"
        echo -e "| 9 | Back"
        echo -e "+---+"
        read -n 1 -t 5 -s key
        clear
        exploit_banner
        date
        echo -e "------------------- Exploit Menu --------------------"
        case "$key" in
            1 )
                echo -e "+---+"
                echo -e "| 1 | Create and initialize the msf database"
                echo -e "+---+"
                tmux send-keys -t $WINDOW_NAME.1 'msfdb init' C-m
                echo -e "Press any key to continue..."
                read;;
            2 )
                echo -e "+---+"
                echo -e "| 2 | Delete msf database"
                echo -e "+---+"
                echo -e "Do you really want to delete?"
                echo -e "${GREEN_b}+---+         ${RED_b}+---+${NC}"
                echo -e "${GREEN_b}| 1 | yes  ${NC}|  ${RED_b}| 2 | no${NC}"
                echo -e "${GREEN_b}+---+         ${RED_b}+---+${NC}"                read -n 1 -s ans
                if [ $ans -eq 1 ];then
                    tmux send-keys -t $WINDOW_NAME.1 'msfdb delete' C-m
                    echo -e "Press any key to continue..."
                    read
                fi;;
            3 )
                echo -e "+---+"
                echo -e "| 3 | Start Matasploit"
                echo -e "+---+"
                tmux send-keys -t $WINDOW_NAME.1 'msfconsole' C-m
                sleep 20
                echo -e "Press any key to continue..."
                read;;
            4 )
                echo -e "+---+"
                echo -e "| 4 | Import to msf database"
                echo -e "+---+"
                #find $WDIR -name \*.xml > .temp
                #cat .temp | while read line
                #do
                #    tmux send-keys -t $WINDOW_NAME.1 "db_import $line" C-m
                #done
                #rm .temp
                for i in `find $WDIR -name \*.xml`
                do
                    tmux send-keys -t $WINDOW_NAME.1 "db_import $i" C-m
                done
                echo -e "Press any key to continue..."
                read;;
            5 )
                echo -e "+---+"
                echo -e "| 5 | Check the hosts registered in the msf database"
                echo -e "+---+"
                tmux send-keys -t $WINDOW_NAME.1 'hosts' C-m
                echo -e "Press any key to continue..."
                read;;
            6 )
                echo -e "+---+"
                echo -e "| 6 | Check the services registered in the msf database"
                echo -e "+---+"
                tmux send-keys -t $WINDOW_NAME.1 'services' C-m
                echo -e "Press any key to continue..."
                read;;
            9 )
                echo -e "Running Metasploit termination processing..."
                tmux send-keys -t $WINDOW_NAME.1 'exit -y' C-m
                sleep 2
                if [ `tmux list-panes|wc -l` = 1 ];then
                    tmux split-window -t $SESSION_NAME.0 -h
                    tmux select-pane -t $SESSION_NAME.0
                else
                    tmux send-keys -t $WINDOW_NAME.1 'clear' C-m
                fi
                break ;;
            * )
                echo -e "Error";;
        esac
    done
}